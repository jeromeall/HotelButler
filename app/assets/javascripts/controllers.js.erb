var hotelButlerCtrls = angular.module("hotelButlerCtrls", []);

hotelButlerCtrls.controller('stayIndexCtrl',['$scope','Stay', function($scope, Stay){
  //Get all the stays
  $scope.stays = Stay.query();

  //nghide function for new form creation if no stays exist
  $scope.existingStay = function(){
    if($scope.stays === []){
      return false;
    }else{
      return true;
    }
  };

}])

.controller('stayCreateCtrl',['$scope','$location','Stay', 'Hotel', 
  function($scope,$location, Stay, Hotel){

  //Query hotels for drop down select
  $scope.hotels = Hotel.query();

  //date options for datepicker
  $scope.dateOptions = {
    changeYear: true,
    changeMonth: true,
    yearRange: '2014:2020'
  };

  $scope.createStay = function() {
    //create the stay object to send to back-end
    console.log($scope.stay);
    var stay = new Stay($scope.stay);

    stay.$save(function() {
      // console.log(stay.id);
      // redirect to root path CHANGE LATER TO STAY
      $location.path("/stays/:" + stay.id);
    }, function(response) {
      //post response objects to the view
      $scope.errors = response.data.errors;
    });
  };
  
}])

.controller('conciergeCreateCtrl',['$scope','Concierge','$routeParams', '$location',
   function($scope, Concierge, $routeParams, $location){
   
   $scope.concierges = Concierge.query({stay_id: $routeParams.stay_id});
   $scope.dateOptions = {
    changeYear: true,
    changeMonth: true,
    yearRange: '2014:2020'
  };

  $scope.createConcierge = function() {
    
    var concierge = new Concierge({
      event_type: $scope.event_type,
      event_date: $scope.event_date,
      num_party: parseInt($scope.num_party),
      details: $scope.details
    });

    concierge.$save({
      stay_id: parseInt($routeParams.stay_id)
    },
      function() {
      // $location.path('/');
    }, function(response) {
      //post response objects to the view
      $scope.errors = response.data.errors;
    });
  };

  }])

  .controller('housekeepingCreateCtrl', ['$scope', 'Housekeeping', '$routeParams','$location', 
  function($scope, Housekeeping, $routeParams, $location){


    $scope.createHousekeeping = function(){
      
    var housekeeping = new Housekeeping({
      request: $scope.request
    });

    housekeeping.$save({
      stay_id: parseInt($routeParams.stay_id)
    },
    function() {
      // $location.path('/')
    }, function(response) {
      $scope.errors = response.data.errors;
    });
  };

  }])

  .controller('roomserviceCreateCtrl', ['$scope', 'Roomservice','MenuItem', '$routeParams', '$location',
    function($scope, Roomservice, MenuItem, $routeParams, $location) {
      $scope.menu_items = MenuItem.query({stay_id: $routeParams.stay_id});
    }

    ]);





